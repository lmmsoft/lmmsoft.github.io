{% if page.layout == 'post' %}
<div class="sidebar-module toc">
  <h4>{{ site.locales[site.default_locale].TableOfContents }}</h4>
  <div id="toc-content">
    <!-- TOC will be generated by JavaScript -->
  </div>
</div>

<script>
// 生成文章目录
document.addEventListener('DOMContentLoaded', function() {
  var tocContainer = document.getElementById('toc-content');
  if (!tocContainer) return;
  
  var headings = document.querySelectorAll('.post-content h1, .post-content h2, .post-content h3, .post-content h4, .post-content h5, .post-content h6');
  
  if (headings.length === 0) {
    tocContainer.parentElement.style.display = 'none';
    return;
  }
  
  var toc = document.createElement('ul');
  toc.className = 'toc-list';
  
  headings.forEach(function(heading, index) {
    // 为标题添加ID（如果没有的话）
    if (!heading.id) {
      heading.id = 'heading-' + index;
    }
    
    var li = document.createElement('li');
    li.className = 'toc-level-' + heading.tagName.toLowerCase();
    
    var link = document.createElement('a');
    link.href = '#' + heading.id;
    link.textContent = heading.textContent;
    
    li.appendChild(link);
    toc.appendChild(li);
  });
  
  tocContainer.appendChild(toc);
});
</script>

<style>
.toc .toc-list {
  list-style: none;
  padding-left: 0;
  margin: 0;
}

.toc .toc-list li {
  margin: 4px 0;
  font-size: 13px;
}

.toc .toc-list li a {
  text-decoration: none;
  color: #337ab7;
  display: block;
  padding: 2px 0;
}

.toc .toc-list li a:hover {
  color: #23527c;
  text-decoration: underline;
}

.toc .toc-level-h1 {
  font-weight: bold;
}

.toc .toc-level-h2 {
  padding-left: 10px;
}

.toc .toc-level-h3 {
  padding-left: 20px;
}

.toc .toc-level-h4 {
  padding-left: 30px;
}

.toc .toc-level-h5 {
  padding-left: 40px;
}

.toc .toc-level-h6 {
  padding-left: 50px;
}
</style>
{% endif %}