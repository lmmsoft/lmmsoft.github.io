---
title: poj2407 欧拉定理解题报告报告
date: 2010-10-31 08:04:00 +0800
layout: post
published: true
comments: true
category: acm比赛
moveForm: baidu_qing
---
<div> <p><a rel="nofollow" href="http://poj.org/problem?id=2407"  >http://poj.org/problem?id=2407</a></p><p>Description</p><p>Given n, a positive integer, how many positive integers less than n are relatively prime to n? Two integers a and b are relatively prime if there are no integers x &gt; 1, y &gt; 0, z &gt; 0 such that a = xy and b = xz. <br />Input</p><p>就是求小于n且与n互质的数的个数</p><p>这题使用到欧拉函数：<br />对正整数n，欧拉函数是少于或等于n的数中与n互质的数的数目。此函数以其首名研究者欧拉命名，它又称为Euler's totient function、φ函数、欧拉商数等。 例如φ(8)=4，因为1,3,5,7均和8互质。</p><p>φ函数的值<br />　　通式：φ(x)=x(1-1/p1)(1-1/p2)(1-1/p3)(1-1/p4)…..(1-1/pn),其中p1, p2……pn为x的所有质因数，x是不为0的整数。φ(1)=1（唯一和1互质的数就是1本身）。<br />　　若n是质数p的k次幂，φ(n)=p^k-p^(k-1)=(p-1)p^(k-1)，因为除了p的倍数外，其他数都跟n互质。<br />　　欧拉函数是积性函数&mdash;&mdash;若m,n互质，φ(mn)=φ(m)φ(n)。<br />　　特殊性质：当n为奇数时，φ(2n)=φ(n), 证明于上述类似。</p><p>证明略</p><p>举例：<br />　　ψ（１０）＝１０×（１－１/２）×（１－１/５）＝４；<br />　　ψ（３０）＝３０×（１－１/２）×（１－１/３）×（１－１/５）＝８；<br />　　ψ（４９）＝４９×（１－１/７）＝４２。</p><p>我的代码：<br />#include&lt;cstdio&gt;<br />#include&lt;iostream&gt;<br />using namespace std;<br />#include&lt;cmath&gt;<br />int num[100000];<br />int f_Euler(int s,int a)//返回欧拉数的个数，s是数组num里数据的个数，a是原来输入数据，即n<br />{<br /> double ans=a;<br /> int i;<br /> for(i=1;i&lt;=s;i++)<br /> {<br />&nbsp;&nbsp; ans*=(1-1.0/num[i]);<br /> }<br /> return (int)(ans+0.1);<br />}<br />int main()<br />{<br /> num[0]=1;//无用<br /> int a,b,s,i,max,t;<br /> while(scanf(&quot;%d&quot;,&amp;a)&amp;&amp; a)<br /> {<br />&nbsp;&nbsp; t=a;<br />&nbsp;&nbsp; s=0;<br />&nbsp;&nbsp; //以下为分解质因数<br />&nbsp;&nbsp; max=sqrt(double(a))+1;<br />&nbsp;&nbsp; if(a%2==0){<br />&nbsp;&nbsp;&nbsp; while(a%2==0){<br />&nbsp;&nbsp;&nbsp;&nbsp; a=a/2;<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; num[++s]=2;<br />&nbsp;&nbsp; }<br />&nbsp;&nbsp; for(int i=3;i&lt;=max;i+=2)<br />&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; if(a%i==0){<br />&nbsp;&nbsp;&nbsp;&nbsp; while(a%i==0){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a=a/i;<br />&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp; num[++s]=i;<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp; }<br />&nbsp;&nbsp; if(a!=1)num[++s]=a;//分解最后剩下的数（可能大于sqrt(n)）<br />&nbsp;&nbsp; printf(&quot;%d\n&quot;,f_Euler(s,t));<br />&nbsp;&nbsp; memset(num,0,sizeof(int)*s);<br /> } <br /> return 0;<br />}</p><p>poj上一个优化的代码：<br />while(scanf(&quot;%d&quot;,&amp;n),n != 0){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  if(n == 1){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  printf(&quot;0\n&quot;);  continue;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ans = n;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  for(int i = 2;i*i &lt;= n;++i){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  if( n % i == 0 ){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ans = ans - ans/i;//见注释<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  while(n%i == 0){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  n /= i;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  // n is prime itself<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  if(n != 1)  ans = ans - ans / n;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  printf(&quot;%d\n&quot;,ans);<br />&nbsp;&nbsp;&nbsp;  }<br />注释：<br />ans = ans - ans/i其实就是<br />欧拉定理ans*=(1-1.0/num[i]);的简化版，深入理解欧拉函数后就知道是：ans/i是小于等于ans被i整除的数的个数..</p><p>附：<br />2-100欧拉函数表（供测试用）<br />　　n φ(n)<br />　　2 1<br />　　3 2<br />　　4 2<br />　　5 4<br />　　6 2<br />　　7 6<br />　　8 4<br />　　9 6<br />　　10 4<br />　　11 10<br />　　12 4<br />　　13 12<br />　　14 6<br />　　15 8<br />　　16 8<br />　　17 16<br />　　18 6<br />　　19 18<br />　　20 8<br />　　21 12<br />　　22 10<br />　　23 22<br />　　24 8<br />　　25 20<br />　　26 12<br />　　27 18<br />　　28 12<br />　　29 28<br />　　30 8<br />　　31 30<br />　　32 16<br />　　33 20<br />　　34 16<br />　　35 24<br />　　36 12<br />　　37 36<br />　　38 18<br />　　39 24<br />　　40 16<br />　　41 40<br />　　42 12<br />　　43 42<br />　　44 20<br />　　45 24<br />　　46 22<br />　　47 46<br />　　48 16<br />　　49 42<br />　　50 20<br />　　51 32<br />　　52 24<br />　　53 52<br />　　54 18<br />　　55 40<br />　　56 24<br />　　57 36<br />　　58 28<br />　　59 58<br />　　60 16<br />　　61 60<br />　　62 30<br />　　63 36<br />　　64 32<br />　　65 48<br />　　66 20<br />　　67 66<br />　　68 32<br />　　69 44<br />　　70 24<br />　　71 70<br />　　72 24<br />　　73 72<br />　　74 36<br />　　75 40<br />　　76 36<br />　　77 60<br />　　78 24<br />　　79 78<br />　　80 32<br />　　81 54<br />　　82 40<br />　　83 82<br />　　84 24<br />　　85 64<br />　　86 42<br />　　87 56<br />　　88 40<br />　　89 88<br />　　90 24<br />　　91 72<br />　　92 44<br />　　93 60<br />　　94 46<br />　　95 72<br />　　96 32<br />　　97 96<br />　　98 42<br />　　99 60<br />　　100 40</p> </div>
