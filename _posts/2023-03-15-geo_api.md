---
title:  "åœ°ç†ä¿¡æ¯APIæ¨è: Nominatim/MapQuest/GoogleMap"
date: 2023-03-15T00:00:00+08:00
author: lmm333
layout: post
comments: true
published: true
permalink: /geo_api/
categories:
- æŒ¨è¸¢ç”Ÿæ¶¯
tags:
- åœ°ç†
---

# Part1: Nominatim(OpenStreenMap/OSM)

æ™šä¸Šè°ƒç ”äº†ä¸€ä¸‹åœ°ç†ä¿¡æ¯çš„APIï¼Œå‘ç°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„API: Nominatim
- å¯ä»¥æ ¹æ®åœ°å€æŸ¥è¯¢è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…å«ç»çº¬åº¦ï¼Œå„ç§äººç±»è¯­è¨€çš„åç§°ï¼Œé‚®ç¼–ç­‰ç­‰ï¼‰
- è¿˜å¯ä»¥æ ¹æ®ç»çº¬åº¦æŸ¥è¯¢åŒæ ·çš„è¯¦æƒ…ä¿¡æ¯

## æ•°æ®æº
æ•°æ®æ¥æºæ˜¯ [OpenStreetMap](https://www.openstreetmap.org/) ï¼Œä¸€ä¸ªå¼€æ”¾çš„åœ°å›¾æ•°æ®é¡¹ç›®

[Nominatim](https://nominatim.openstreetmap.org/ui/about.html) æ˜¯OpenStreetMapçš„æœç´¢å¼•æ“

è¯¥APIç”±Nominatimæä¾›ï¼Œ[å®˜æ–¹ API æ–‡æ¡£](https://nominatim.org/release-docs/develop/api/Overview/)

## ä½¿ç”¨ä¸¾ä¾‹
<!--more-->
### æ ¹æ®åœ°å€æŸ¥è¯¢
- æ–‡æ¡£
  - https://nominatim.org/release-docs/develop/api/Search/
- ä»¥æŸ¥è¯¢æŸ¥è¯¢ è‹±å›½å¤§æœ¬é’Ÿ "big ben" ä¸ºä¾‹
- ç½‘é¡µä½“éªŒï¼š
> https://nominatim.openstreetmap.org/ui/search.html?q=big+ben

![geo_ui](../images/2023/2023-other/23-03-15-geo_api.png)
- APIåœ°å€
> https://nominatim.openstreetmap.org/search?q=big+ben&format=json&polygon_geojson=1&addressdetails=1
- APIè¿”å›ï¼š
```json
[
  {
    "place_id": 16357159,
    "licence": "Data Â© OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright",
    "osm_type": "node",
    "osm_id": 1802652184,
    "boundingbox": [
      "51.5006542",
      "51.5007542",
      "-0.1246221",
      "-0.1245221"
    ],
    "lat": "51.5007042",
    "lon": "-0.1245721",
    "display_name": "å¤§æœ¬é’Ÿ, Bridge Street, Westminster, Millbank, City of Westminster, Greater London, è‹±æ ¼å…° / è‹±æ ¼è˜­, SW1A 2JX, è‹±å›½ / è‹±åœ‹",
    "class": "tourism",
    "type": "attraction",
    "importance": 0.5169301795209977,
    "icon": "https://nominatim.openstreetmap.org/ui/mapicons/poi_point_of_interest.p.20.png",
    "address": {
      "tourism": "å¤§æœ¬é’Ÿ",
      "road": "Bridge Street",
      "quarter": "Westminster",
      "suburb": "Millbank",
      "city": "City of Westminster",
      "ISO3166-2-lvl8": "GB-WSM",
      "state_district": "Greater London",
      "state": "è‹±æ ¼å…° / è‹±æ ¼è˜­",
      "ISO3166-2-lvl4": "GB-ENG",
      "postcode": "SW1A 2JX",
      "country": "è‹±å›½ / è‹±åœ‹",
      "country_code": "gb"
    },
    "geojson": {
      "type": "Point",
      "coordinates": [
        -0.1245721,
        51.5007042
      ]
    }
  },
  {
    "place_id": 133736079,
    ... è¿˜æœ‰æœ‰å¾ˆå¤šå« big ben çš„åœ°æ–¹ï¼Œè¿”å›å€¼æ˜¯åˆ—è¡¨ï¼Œæ­¤å¤„çœç•¥è‹¥å¹²åŒ…å«ä¸åŒåä¸ºbig bençš„åœ°ç‚¹
  }
]
```

## å¤‡æ³¨ï¼š
- ä¼˜ç‚¹ï¼šæ— éœ€æ³¨å†Œï¼Œå…è´¹ï¼Œä¹Ÿä¸å­˜åœ¨æ³¨å†Œå’Œä»˜è´¹çš„æ¸ é“ï¼ŒQPSæœ‰ä¸€å®šé™åˆ¶ï¼Œå®˜æ–¹è¦æ±‚æ˜¯ 1 query/secondï¼Œäº²æµ‹é¢‘ç‡é«˜äº†ä¼šæŠ¥é”™
- ç¼ºç‚¹ï¼šéœ€è¦ç§‘å­¦ä¸Šç½‘

# Part2: MapQuest

## ä»‹ç»
- æ„Ÿè§‰ç”¨çš„æ˜¯OSMçš„æ•°æ®å’Œ Hereï¼ˆæ›¾ç»è¢«è¯ºåŸºäºšé«˜ä»·æ”¶è´­çš„åœ°å›¾æœåŠ¡ï¼‰çš„åœ°å›¾(ä¸æ˜¯å¾ˆç¡®å®š)
- åœ°å›¾å®˜ç½‘ https://www.mapquest.com/
- APIç½‘å€ https://developer.mapquest.com/ ï¼ˆéœ€è¦æ³¨å†Œï¼‰
- APIæ–‡æ¡£ï¼š https://developer.mapquest.com/documentation/
- æ¯ä¸ªæœˆ 15000 æ¬¡å…è´¹ API æŸ¥è¯¢ï¼ŒåŸºæœ¬å¤Ÿç”¨äº†ï¼Œæˆ‘ç”¨è¶…äº†ä¸€æ¬¡ï¼Œæ„Ÿè§‰ä»˜è´¹æœ‰ç‚¹è´µï¼Œå°±æ³¨å†Œäº†å°å·(ç”Ÿæˆæ–°çš„API KEY)ä¸´æ—¶é¡¶ä¸€ä¸‹
  
## ä½¿ç”¨ä¸¾ä¾‹
- APIæ–‡æ¡£: https://developer.mapquest.com/documentation/geocoding-api/address/get
- å‚è€ƒè¯·æ±‚: > GET https://www.mapquestapi.com/geocoding/v1/address?key=KEY&location=Washington,DC
- æ„Ÿè§‰APIçš„ç»“æœè´¨é‡å’Œç»“æ„æ¯” Nominatim(OpenStreenMap/OSM) ç¨å¾®å¥½ä¸€ç‚¹ï¼Œæ¯”å¦‚åœ°ç†ä½ç½®çš„å±‚çº§ä¼šç”¨ adminArea1-6æ ‡æ³¨ç±»å‹å’Œåç§°ï¼Œè€ŒNominationåˆ™åªæœ‰ "city", "city_district", "municipality", "village", "county" è¿™ç±»keyï¼Œä¸åŒå›½å®¶æä¸æ¸…æ¥šä¼šç”¨å“ªä¸ªkeyï¼Œå¤§å°å…³ç³»æ˜¯ä»€ä¹ˆ
- å‚è€ƒè¿”å›
```
{
  "info": {
    "statuscode": 0,
    "copyright": {
      "text": "Â© 2023 MapQuest, Inc.",
      "imageUrl": "https://api.mqcdn.com/res/mqlogo.gif",
      "imageAltText": "Â© 2023 MapQuest, Inc."
    },
    "messages": []
  },
  "options": {
    "maxResults": -1,
    "thumbMaps": true,
    "ignoreLatLngInput": false
  },
  "results": [
    {
      "providedLocation": {
        "location": "Washington,DC"
      },
      "locations": [
        {
          "street": "",
          "adminArea6": "",
          "adminArea6Type": "Neighborhood",
          "adminArea5": "Washington",
          "adminArea5Type": "City",
          "adminArea4": "District of Columbia",
          "adminArea4Type": "County",
          "adminArea3": "DC",
          "adminArea3Type": "State",
          "adminArea1": "US",
          "adminArea1Type": "Country",
          "postalCode": "",
          "geocodeQualityCode": "A5XAX",
          "geocodeQuality": "CITY",
          "dragPoint": false,
          "sideOfStreet": "N",
          "linkId": "282772166",
          "unknownInput": "",
          "type": "s",
          "latLng": {
            "lat": 38.892062,
            "lng": -77.019912
          },
          "displayLatLng": {
            "lat": 38.892062,
            "lng": -77.019912
          },
          "mapUrl": "https://www.mapquestapi.com/staticmap/v4/getmap?key=KEY&type=map&size=225,160&pois=purple-1,38.892062,-77.019912,0,0,|&center=38.892062,-77.019912&zoom=12&rand=306744981"
        }
      ]
    }
  ]
}
```

# Part3: Google Map API

## ç®€ä»‹
- å¤§åé¼é¼çš„è°·æ­Œåœ°å›¾APIï¼Œæ— éœ€å¤šè¨€ï¼Œåº”è¯¥æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„åœ°å›¾
- ä¼˜ç‚¹ï¼š
  - åŠŸèƒ½å®Œå–„ï¼Œæ•°æ®å¼ºå¤§ï¼Œå¤šè¯­è¨€æ”¯æŒä¸°å¯Œï¼Œæ–‡æ¡£ä¸°å¯Œ
  - è¿˜æœ‰å¤šç§è¯­è¨€çš„SDKï¼Œå¼€å‘æ•ˆç‡é«˜
- ç¼ºç‚¹ï¼š
  - è¦é’±ï¼Œä»¥ä¸‹é¢æŸ¥è¯¢åœ°ç†ä½ç½®çš„ä¿¡æ¯çš„APIä¸ºä¾‹ï¼Œ$5/1000æ¬¡æŸ¥è¯¢ï¼Œæ¢æˆäººæ°‘å¸ï¼Œå¤§çº¦3åˆ†é’±ä¸€æ¬¡æŸ¥è¯¢
  - è¦å…ˆæ³¨å†Œè°·æ­Œäº‘(æœ‰äº›æŠ€å·§ï¼Œè¦)ï¼Œä¸€å®šè¦ç»‘å®šä¿¡ç”¨å¡(äº²æµ‹å›½å†…çš„AE/VISAå¯ä»¥ä½¿ç”¨)ï¼Œæ–°ç”¨æˆ·æœ‰ 3ä¸ªæœˆ$100çš„å…è´¹é¢åº¦

## å‚è€ƒé“¾æ¥
- æŸ¥è¯¢åœ°ç†ä½ç½®çš„API https://developers.google.com/maps/documentation/geocoding?hl=zh_CN
- å¤šè¯­è¨€æ”¯æŒ https://developers.google.com/maps/faq?hl=zh-cn#languagesupport
- åœ°åŸŸç¼–ç  https://developers.google.com/maps/documentation/geocoding/requests-geocoding?hl=zh-cn#RegionCodes

## å‚è€ƒä»£ç  JAVA SDKï¼Œ æŸ¥è¯¢åœ°ç†ä¿¡æ¯
```java
import com.google.maps.GeoApiContext;
import com.google.maps.GeocodingApi;
import com.google.maps.errors.ApiException;
import com.google.maps.model.AddressComponent;
import com.google.maps.model.GeocodingResult;
import com.google.maps.model.Geometry;

public static List<GeocodingResult> search(String query, String language, String countryCode) {
    // Create a client object with the API key
    GeoApiContext context = new GeoApiContext
            .Builder()
            .apiKey(apiKey)
            .build();

    GeocodingResult[] results;
    try {
        // Send a request to the Places API to retrieve the place details
        results = GeocodingApi
                .geocode(context, query)
                .language(language)
                .region(countryCode)
                .await();
    } catch (ApiException | InterruptedException | IOException e) {
        e.printStackTrace();
        return null;
    }

    return Arrays.asList(results);
}

public static void main(String[] args) {
    search("Gazion", "el", "GR"); // æŸ¥è¯¢ åœ°å "Gazion"ï¼Œåœ¨ ğŸ‡¬ğŸ‡·å¸Œè…Šå›½èŒƒå›´å†…æŸ¥è¯¢ï¼Œå¹¶ä½¿ç”¨"å¸Œè…Šè¯­"è¿”å›
}
```
